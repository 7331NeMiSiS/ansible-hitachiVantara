- name: Hitachi Vantara storage module example - Get Lun Info
  hosts: caas
  gather_facts: yes
  vars:
  vars_files:
    - ./storage_registration.yml
  tasks:
    # first task is getting Lun information
    - name: get lun information
      uri:
        url: "{{ url_prefix }}/storage/logical-units/{{ lun_id }}"
        method: GET
        headers:
          X-Subsystem-User: "{{ user }}"
          X-Subsystem-Password: "{{ password }}"
          X-Subsystem-Type: "{{ storage_type }}"
          X-Management-IPs: "{{ storage_IP }}"
          X-Storage-Id: "{{ storage_serial }}"
          Content-Type: "application/json"
        validate_certs: no
        return_content: yes
      ignore_errors: yes
      register: get_lun

    - name: show lun information
      debug: msg="{{ get_lun.json }}"

    - copy: content="{{ get_lun.json }}" dest=/root/jsons/get_lun.log


